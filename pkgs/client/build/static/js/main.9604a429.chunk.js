(this["webpackJsonp@mizan/client"]=this["webpackJsonp@mizan/client"]||[]).push([[1],{134:function(e,n,t){var r={"./ion-action-sheet.entry.js":[186,5],"./ion-alert.entry.js":[187,6],"./ion-app_8.entry.js":[188,7],"./ion-avatar_3.entry.js":[189,17],"./ion-back-button.entry.js":[190,18],"./ion-backdrop.entry.js":[191,43],"./ion-button_2.entry.js":[192,19],"./ion-card_5.entry.js":[193,20],"./ion-checkbox.entry.js":[194,21],"./ion-chip.entry.js":[195,22],"./ion-col_3.entry.js":[196,44],"./ion-datetime_3.entry.js":[197,10],"./ion-fab_3.entry.js":[198,23],"./ion-img.entry.js":[199,45],"./ion-infinite-scroll_2.entry.js":[200,46],"./ion-input.entry.js":[201,24],"./ion-item-option_3.entry.js":[202,25],"./ion-item_8.entry.js":[203,26],"./ion-loading.entry.js":[204,27],"./ion-menu_3.entry.js":[205,28],"./ion-modal.entry.js":[206,8],"./ion-nav_2.entry.js":[207,14],"./ion-popover.entry.js":[208,9],"./ion-progress-bar.entry.js":[209,29],"./ion-radio_2.entry.js":[210,30],"./ion-range.entry.js":[211,31],"./ion-refresher_2.entry.js":[212,11],"./ion-reorder_2.entry.js":[213,16],"./ion-ripple-effect.entry.js":[214,47],"./ion-route_4.entry.js":[215,32],"./ion-searchbar.entry.js":[216,33],"./ion-segment_2.entry.js":[217,34],"./ion-select_3.entry.js":[218,35],"./ion-slide_2.entry.js":[219,48],"./ion-spinner.entry.js":[220,13],"./ion-split-pane.entry.js":[221,49],"./ion-tab-bar_2.entry.js":[222,36],"./ion-tab_2.entry.js":[223,15],"./ion-text.entry.js":[224,37],"./ion-textarea.entry.js":[225,38],"./ion-toast.entry.js":[226,39],"./ion-toggle.entry.js":[227,12],"./ion-virtual-scroll.entry.js":[228,50]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=134,e.exports=c},136:function(e,n,t){var r={"./ion-icon.entry.js":[229,57]};function c(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],c=n[0];return t.e(n[1]).then((function(){return t(c)}))}c.keys=function(){return Object.keys(r)},c.id=136,e.exports=c},141:function(e,n,t){},143:function(e,n,t){},149:function(e,n,t){},150:function(e,n,t){},152:function(e,n,t){},153:function(e,n,t){},155:function(e,n,t){},156:function(e,n,t){},157:function(e,n,t){},158:function(e,n,t){},159:function(e,n,t){},170:function(e,n,t){},180:function(e,n,t){"use strict";t.r(n);var r,c=t(2),i=t.n(c),a=t(59),l=t.n(a),d=t(49),o=t(3),s=t(112),u=(t(141),t(18));t(143);!function(e){e.UPDATE_SCOREBOARD="UPDATE_SCOREBOARD",e.UPDATE_RECORD_DRAFT="UPDATE_RECORD_DRAFT",e.UPDATE_RECORD_RESULT="UPDATE_RECORD_RESULT",e.UPDATE_RECORD_QUERY="UPDATE_RECORD_QUERY",e.UPDATE_RECORD_LIST="UPDATE_RECORD_LIST",e.UPDATE_UI_STATE="UPDATE_UI_STATE",e.RESET_RECORD_DRAFT="RESET_RECORD_DRAFT",e.RESET_SCOREBOARD="RESET_SCOREBOARD",e.CAPTURE_READING="CAPTURE_READING",e.DELETE_RECORD_DRAFT="DELETE_RECORD_DRAFT"}(r||(r={}));var j,b,h,v,O,m,p,f,g,x,y,R,N,w,D,C=function(e){return function(n){return n({type:r.UPDATE_SCOREBOARD,payload:e})}},E=function(e){return function(n){return n({type:r.UPDATE_UI_STATE,payload:e})}},I=function(e){return function(n){return n({type:r.UPDATE_RECORD_DRAFT,payload:e})}},S=function(e){return function(n){return n({type:r.UPDATE_RECORD_RESULT,payload:e})}},A=function(e){return function(n){return n({type:r.UPDATE_RECORD_QUERY,payload:e})}},P=function(){return function(e){return e({type:r.DELETE_RECORD_DRAFT})}},T=t(234),_=t(33),k=t.n(_),$=t(24),U=t(243),F=Object(U.a)(j||(j=Object($.a)(["\n  subscription {\n    reading\n  }\n"]))),L=t(7),B=t(88),q=t.n(B),M="OK",Q="ERROR",V="LOADING",G=t(122),W=t(0),H=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SERVER_PORT:"8998"}).REACT_APP_INDICATOR_ENDPOINT||"http://192.168.8.100:6969",K=Object(u.b)((function(e){return{reading:e.scoreboard.reading,ui:e.ui}}),{updateReading:C,updateUIState:E,deleteRecordDraft:P})((function(e){var n,t,r,i,a,l,d,s,u,j,b=Object(T.a)(F),h=Object(c.useRef)(0);Object(c.useEffect)((function(){var n=Object(G.a)(H);return e.ui.manualInput?b.error?e.updateReading({receivedAt:(new Date).getTime(),weight:0,manual:!1,status:Q}):b.loading&&!e.ui.manualInput?e.updateReading({receivedAt:(new Date).getTime(),weight:0,manual:!1,status:V}):b.data&&e.ui.manualInput:n.on("reading",(function(n){var t=(new Date).getTime();console.log("data",{data:n,now:t}),e.updateReading({receivedAt:t,weight:+n||0,manual:!1,status:M})})),setInterval((function(){h.current=(new Date).getTime()}),1e3),function(){n.off("reading")}}),[b.data,b.error,b.loading,e]);var v=null===(n=e.ui)||void 0===n?void 0:n.manualInput;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("div",{className:k()({scoreboard:!0,error:(null===(t=e.reading)||void 0===t?void 0:t.status)===Q||Math.abs(h.current-(null===(r=e.reading)||void 0===r?void 0:r.receivedAt))>2e3,warn:(null===(i=e.reading)||void 0===i?void 0:i.status)===V}),children:Object(W.jsxs)("div",{className:"scoreboard-wrap",children:[Object(W.jsx)(o.h,{onClick:function(){return function(){var n;!e.ui.manualInput&&e.updateReading({receivedAt:(new Date).getTime(),weight:(null===(n=e.reading)||void 0===n?void 0:n.weight)||0,manual:!0}),e.updateUIState({manualInput:!e.ui.manualInput}),setTimeout((function(){q()("#scoreboard-input").focus()}),300)}()},color:v?"secondary":"success",className:"manual-input-button",children:Object(W.jsx)(o.j,{icon:v?L.n:L.D})}),Object(W.jsx)("div",{className:"scoreboard-text",children:v?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(o.k,{id:"scoreboard-input",color:"secondary",autofocus:!0,clearInput:!0,onIonChange:function(n){e.updateReading({receivedAt:(new Date).getTime(),weight:+n.detail.value,manual:!0})},className:"reading",placeholder:(null===(a=e.reading)||void 0===a?void 0:a.weight)||0,type:"number"}),Object(W.jsx)("span",{className:k()("unit",v&&"manual-input-unit"),children:"KG"})]}):(null===(l=e.reading)||void 0===l?void 0:l.status)===M?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("span",{className:"reading",children:null===(d=e.reading)||void 0===d?void 0:d.weight.toLocaleString()}),Object(W.jsx)("span",{className:k()("unit",e.ui.manualInput&&"manual-input-unit"),children:"KG"})]}):Object(W.jsx)("span",{className:"reading reading-status",children:null===(s=e.reading)||void 0===s?void 0:s.status})})]})}),Object(W.jsx)("div",{className:k()({"status-bar":!0,error:(null===(u=e.reading)||void 0===u?void 0:u.status)===Q,warn:(null===(j=e.reading)||void 0===j?void 0:j.status)===V})})]})})),z=t(72),Y=t(5),Z=t(26),J=(t(149),["OTHER",1,2,3,4,5]),X=[{code:"OTHER",name:"OTHER"},{code:"AA",name:"ADDIS ABABA"},{code:"AF",name:"AFAR"},{code:"AM",name:"AMHARA"},{code:"BG",name:"BENI SHANGUL GUMUZ"},{code:"DR",name:"DIRE DAWA"},{code:"ET",name:"ETHIOPIA"},{code:"GB",name:"GAMBELLA"},{code:"HR",name:"HARARI"},{code:"OR",name:"OROMIA"},{code:"SI",name:"SIDAMA"},{code:"SM",name:"SOMALI"},{code:"SP",name:"SOUTHERN PEOPLE"},{code:"TG",name:"TIGRAY"}],ee=["PICK UP","ISUZU","FSR","SINO TRUCK","TRAILER TRUCK"],ne=t(237),te=t(235),re=Object(U.a)(b||(b=Object($.a)(["\n  query FetchRecords(\n    $query: String\n    $limit: Int\n    $page: Int\n    $vehicleId: String\n    $serial: String\n    $filters: [String]\n  ) {\n    records(\n      query: $query\n      limit: $limit\n      page: $page\n      vehicleId: $vehicleId\n      serial: $serial\n      filters: $filters\n    ) {\n      payload {\n        id\n        createdAt\n        serial\n        weights {\n          weight\n          manual\n          createdAt\n        }\n        vehicle {\n          id\n          type\n          licensePlate {\n            code\n            region {\n              code\n            }\n            plate\n          }\n        }\n        buyer {\n          id\n          name {\n            display\n          }\n          phoneNumber {\n            number\n          }\n        }\n        seller {\n          id\n          name {\n            display\n          }\n          phoneNumber {\n            number\n          }\n        }\n      }\n      count\n    }\n  }\n"]))),ce=Object(U.a)(h||(h=Object($.a)(["\n  query FetchRecord($id: String!) {\n    record(id: $id) {\n      id\n      createdAt\n      serial\n      weights {\n        weight\n        manual\n        createdAt\n      }\n      vehicle {\n        id\n        type\n        licensePlate {\n          code\n          region {\n            code\n          }\n          plate\n        }\n      }\n      buyer {\n        id\n        name {\n          display\n        }\n        phoneNumber {\n          number\n        }\n      }\n      seller {\n        id\n        name {\n          display\n        }\n        phoneNumber {\n          number\n        }\n      }\n    }\n  }\n"]))),ie=(t(150),t(41)),ae=t.n(ie),le=(t(152),function(e){var n,t;return Object(W.jsx)("div",{className:k()("licensePlate","code-".concat(e.code)),children:Object(W.jsxs)("div",{className:"licensePlateInner",children:[Object(W.jsx)("span",{className:"licensePlateCode",children:e.code}),Object(W.jsx)("span",{className:"licensePlateNumber",children:e.number}),Object(W.jsx)("span",{className:"licensePlateRegion",children:null===(n=e.region)||void 0===n||null===(t=n.code)||void 0===t?void 0:t.slice(0,2)})]})})}),de=Object(U.a)(v||(v=Object($.a)(["\n  mutation CreateRecord(\n    $weight: Int!\n    $manual: Boolean!\n    $weightTime: String\n    $vehicleId: String!\n    $sellerId: String\n    $buyerId: String\n  ) {\n    createRecord(\n      weight: $weight\n      manual: $manual\n      weightTime: $weightTime\n      vehicleId: $vehicleId\n      sellerId: $sellerId\n      buyerId: $buyerId\n    ) {\n      id\n      serial\n      createdAt\n      updatedAt\n      vehicle {\n        id\n        type\n        licensePlate {\n          code\n          plate\n          region {\n            code\n          }\n        }\n      }\n      buyer {\n        id\n        name {\n          display\n        }\n        phoneNumber {\n          number\n        }\n      }\n      seller {\n        id\n        name {\n          display\n        }\n        phoneNumber {\n          number\n        }\n      }\n    }\n  }\n"]))),oe=Object(U.a)(O||(O=Object($.a)(["\n  mutation AddSecondWeight(\n    $recordId: String!\n    $weight: Int!\n    $manual: Boolean!\n    $createdAt: String!\n  ) {\n    addSecondWeight(\n      recordId: $recordId\n      weight: $weight\n      manual: $manual\n      createdAt: $createdAt\n    ) {\n      id\n    }\n  }\n"]))),se=Object(U.a)(m||(m=Object($.a)(["\n  mutation AddCustomer(\n    $recordId: String!\n    $customerId: String!\n    $customerType: String!\n  ) {\n    addCustomer(\n      recordId: $recordId\n      customerId: $customerId\n      customerType: $customerType\n    ) {\n      id\n    }\n  }\n"]))),ue=Object(U.a)(p||(p=Object($.a)(["\n  mutation PrintRecord($id: String!) {\n    printRecord(id: $id)\n  }\n"]))),je=Object(U.a)(f||(f=Object($.a)(["\n  mutation SendConfirmationSms($recordId: String!) {\n    sendConfirmationSms(recordId: $recordId)\n  }\n"]))),be=Object(U.a)(g||(g=Object($.a)(["\n  query FetchCustomers($phoneNumber: String, $name: String, $limit: Int) {\n    customers(phoneNumber: $phoneNumber, name: $name, limit: $limit) {\n      id\n      createdAt\n      name {\n        display\n      }\n      phoneNumber {\n        number\n      }\n    }\n  }\n"]))),he=Object(U.a)(x||(x=Object($.a)(["\n  query FetchCustomer($id: String) {\n    customer(id: $id) {\n      id\n      createdAt\n      name {\n        display\n      }\n      phoneNumber {\n        number\n      }\n    }\n  }\n"]))),ve=(t(153),Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r,c,i,a,l,d,s,u=null===(s=Object(te.a)(be,{variables:{phoneNumber:"seller"===e.party?null===(n=e.draft)||void 0===n||null===(t=n.seller)||void 0===t?void 0:t.phoneNumber:null===(r=e.draft)||void 0===r||null===(c=r.buyer)||void 0===c?void 0:c.phoneNumber,name:"seller"===e.party?null===(i=e.draft)||void 0===i||null===(a=i.seller)||void 0===a?void 0:a.name:null===(l=e.draft)||void 0===l||null===(d=l.buyer)||void 0===d?void 0:d.name,limit:5},fetchPolicy:"network-only"}).data)||void 0===s?void 0:s.customers;return Object(W.jsx)(W.Fragment,{children:(null===u||void 0===u?void 0:u.length)>0?Object(W.jsx)(o.c,{children:Object(W.jsxs)(o.p,{lines:"full",className:"customer-suggestions entity-card",children:[Object(W.jsx)(o.e,{className:"form-title",children:"Select Existing Customer"}),Object(W.jsx)(o.n,{children:u.map((function(n){var t,r;return Object(W.jsx)(o.l,{button:!0,onClick:function(){return e.onSelectCustomer(n.id,e.party)},children:Object(W.jsxs)("div",{className:"suggestion",children:[Object(W.jsx)("div",{className:"phone-number",children:Object(W.jsx)(o.f,{children:null===(t=n.phoneNumber)||void 0===t?void 0:t.number})}),Object(W.jsx)("div",{className:"name",children:null===(r=n.name)||void 0===r?void 0:r.display})]})},n.id)}))})]})}):""})}))),Oe=Object(U.a)(y||(y=Object($.a)(["\n  mutation CreateCustomer($phoneNumber: String!, $name: String!) {\n    createCustomer(phoneNumber: $phoneNumber, name: $name) {\n      id\n      createdAt\n      name {\n        display\n      }\n      phoneNumber {\n        number\n      }\n    }\n  }\n"]))),me=(t(155),Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r=Object(ne.a)(Oe),c=Object(Z.a)(r,1)[0],i="seller"===e.party?null===(n=e.draft)||void 0===n?void 0:n.seller:null===(t=e.draft)||void 0===t?void 0:t.buyer;return Object(W.jsxs)(o.c,{className:"entity-card",children:[Object(W.jsx)(o.p,{lines:"full",className:"vehicle-suggestions",children:Object(W.jsx)(o.n,{children:Object(W.jsx)(o.m,{children:Object(W.jsx)(o.o,{children:"Add New Customer"})})})}),Object(W.jsxs)(o.d,{className:"customer-form",children:[Object(W.jsxs)("div",{className:"name-wrap",children:[Object(W.jsxs)(o.o,{children:[e.party,"'s Name:"]}),Object(W.jsx)(o.k,{onIonChange:function(n){var t,r=null===(t=n.detail)||void 0===t?void 0:t.value;console.log("change",r);var c="seller"===e.party?{seller:Object(Y.a)(Object(Y.a)({},e.draft.seller),{},{name:r})}:{buyer:Object(Y.a)(Object(Y.a)({},e.draft.buyer),{},{name:r})};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),c))},type:"text",placeholder:"Enter Customer Name"})]}),Object(W.jsxs)("div",{className:"phone-number-wrap",children:[Object(W.jsx)(o.o,{children:"Phone Number: "}),Object(W.jsxs)("div",{className:"phone-number",children:["09",null===i||void 0===i?void 0:i.phoneNumber]})]})]}),Object(W.jsxs)(o.b,{expand:"full",onClick:function(){i&&i.phoneNumber&&i.name?c({variables:{name:i.name,phoneNumber:"09"+i.phoneNumber}}).then((function(n){var t=n.data.createCustomer.id;e.onSelectCustomer(t,e.party)})).catch(console.error):alert("Customer information incomplete")},disabled:!i||!i.name||i.name.length<3||!i.phoneNumber||i.phoneNumber.length<8,children:[Object(W.jsx)(o.j,{icon:L.a}),"Create New Customer"]})]})}))),pe=(t(156),Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r,i,a,l,d,s,u,j,b=Object(te.a)(be,{variables:{phoneNumber:null===(n=e.draft)||void 0===n||null===(t=n.buyer)||void 0===t?void 0:t.phoneNumber,name:null===(r=e.draft)||void 0===r||null===(i=r.buyer)||void 0===i?void 0:i.name,limit:5},fetchPolicy:"network-only"});Object(c.useEffect)((function(){return function(){return b.data}}),[b.data]);var h="seller"===e.party?null===(a=e.draft)||void 0===a?void 0:a.seller:null===(l=e.draft)||void 0===l?void 0:l.buyer;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(o.c,{className:"customer-form entity-card",children:[!e.noTitle&&Object(W.jsxs)(o.e,{className:"form-title",children:["Add ",e.party||"Customer",Object(W.jsxs)(o.b,{fill:"clear",onClick:function(){var n="seller"===e.party?{skipSeller:!0}:{skipBuyer:!0};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),n))},className:"justify-right",children:["Skip",Object(W.jsx)(o.j,{icon:L.h})]})]}),Object(W.jsxs)(o.l,{children:[Object(W.jsxs)(o.o,{className:"uppercase",children:[e.party||"Customer","'s Phone:"]}),Object(W.jsxs)("div",{className:"phone-input",children:[Object(W.jsx)(o.w,{children:"09"}),Object(W.jsx)(o.k,{onIonChange:function(n){var t,r,c,i=null===(t=n.detail)||void 0===t?void 0:t.value.split(/[^0-9]/).join("").trim();n.target.value=i;var a="seller"===e.party?{seller:Object(Y.a)(Object(Y.a)({},null===(r=e.draft)||void 0===r?void 0:r.seller),{},{phoneNumber:i})}:{buyer:Object(Y.a)(Object(Y.a)({},null===(c=e.draft)||void 0===c?void 0:c.buyer),{},{phoneNumber:i})};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),a)),b.refetch()},type:"tel",debounce:500,maxlength:8,size:8,required:!0,autofocus:!0,placeholder:"12345678"})]})]}),Object(W.jsxs)(o.l,{children:[Object(W.jsxs)(o.o,{className:"uppercase",children:[e.party||"Customer","'s Name:"]}),Object(W.jsx)("div",{className:"name-input",children:Object(W.jsx)(o.k,{onIonChange:function(n){var t,r,c,i=null===(t=n.detail)||void 0===t?void 0:t.value.trim(),a="seller"===e.party?{seller:Object(Y.a)(Object(Y.a)({},null===(r=e.draft)||void 0===r?void 0:r.seller),{},{name:i})}:{buyer:Object(Y.a)(Object(Y.a)({},null===(c=e.draft)||void 0===c?void 0:c.buyer),{},{name:i})};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),a)),b.refetch()},type:"text",debounce:500,maxlength:20,placeholder:"Enter Name",clearInput:!0})})]}),Object(W.jsx)("div",{className:"card-footer"})]}),((null===h||void 0===h?void 0:h.phoneNumber)||(null===h||void 0===h?void 0:h.name))&&Object(W.jsxs)(W.Fragment,{children:[(null===(d=b.data)||void 0===d||null===(s=d.customers)||void 0===s?void 0:s.length)>0&&Object(W.jsx)(ve,{onSelectCustomer:e.onSelectCustomer,party:e.party}),0===(null===(u=b.data)||void 0===u||null===(j=u.customers)||void 0===j?void 0:j.filter((function(e){var n=e.phoneNumber,t=null===h||void 0===h?void 0:h.phoneNumber;return n.number==="09"+t})).length)&&Object(W.jsx)(me,{onSelectCustomer:e.onSelectCustomer,party:e.party})]})]})}))),fe=Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft,ui:e.ui}}),{updateRecordResult:S,updateRecordDraft:I,deleteRecordDraft:P,updateUIState:E})((function(e){var n,t,r,i,a,l,d,s,u,j,b,h,v,O,m,p,f,g,x,y,R,N,w=e.record,D=Object(ne.a)(ue),C=Object(Z.a)(D,1)[0],E=Object(ne.a)(je),I=Object(Z.a)(E,1)[0],S=Object(ne.a)(de),A=Object(Z.a)(S,1)[0],P=Object(ne.a)(oe),T=Object(Z.a)(P,1)[0],_=Object(ne.a)(se),$=Object(Z.a)(_,1)[0],U=Object(c.useState)(!1),F=Object(Z.a)(U,2),B=F[0],q=F[1],M=Object(c.useState)(!1),Q=Object(Z.a)(M,2),V=Q[0],G=Q[1],H=Object(o.H)((function(e){var n=e.onHide;return Object(W.jsxs)(o.p,{children:[Object(W.jsxs)(o.l,{button:!0,onClick:function(){Oe(),n()},children:[Object(W.jsx)(o.j,{icon:L.B}),Object(W.jsx)(o.o,{children:"Send SMS"})]}),Object(W.jsxs)(o.l,{button:!0,onClick:function(){ve(),n()},children:[Object(W.jsx)(o.j,{icon:L.u}),Object(W.jsx)(o.o,{children:"Print"})]}),Object(W.jsx)(o.l,{lines:"none",detail:!1,button:!0,onClick:n,children:"Close"})]})}),{onHide:function(){return X()}}),K=Object(Z.a)(H,2),J=K[0],X=K[1],ie=Object(te.a)(ce,{variables:{id:null===(n=e.record)||void 0===n?void 0:n.id},skip:!(null!==(t=e.record)&&void 0!==t&&t.id),fetchPolicy:"network-only"}),be=function(e){return ae()(e).format("dddd - MMM DD, YYYY - h:mm a")},he=function(){var n;return(null===(n=e.draft)||void 0===n?void 0:n.reading)||e.secondWeightDraft},ve=function(){q(!0),C({variables:{id:w.id}}).then((function(){})).catch(console.error)},Oe=function(){I({variables:{recordId:w.id}}).catch(console.error)},me=function(n,t){var r,c,i;A({variables:{weight:n,manual:(null===(r=e.draft)||void 0===r||null===(c=r.reading)||void 0===c?void 0:c.manual)||!1,weightTime:t,vehicleId:null===(i=w.vehicle)||void 0===i?void 0:i.id,sellerId:void 0,buyerId:void 0},update:function(e,n){var t=n.data,r=null===t||void 0===t?void 0:t.createRecord.record,c=e.readQuery({query:re});e.writeQuery({query:re,data:[].concat(Object(z.a)(c.records.payload),[r])})}}).then((function(n){e.updateRecordResult(n.data.createRecord.id),e.deleteRecordDraft(),e.result}))},fe=function(n){e.updateUIState({addCustomerForm:{party:n,recordId:w.id}})},ge=function(){e.updateUIState({addCustomerForm:void 0})},xe=function(){var n,t,r;return(null===(n=e.reading)||void 0===n?void 0:n.weight)===(null===(t=e.draft)||void 0===t||null===(r=t.reading)||void 0===r?void 0:r.weight)},ye=function(){var n,t;return(null===(n=e.draft)||void 0===n||null===(t=n.reading)||void 0===t?void 0:t.weight)>1e3};return Object(W.jsx)(W.Fragment,{children:w&&Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(o.c,{className:"record-card",children:[Object(W.jsx)("div",{className:"card-left-content",children:Object(W.jsxs)(o.p,{children:[(null===w||void 0===w?void 0:w.serial)&&Object(W.jsx)(o.l,{className:"serial-row",children:Object(W.jsx)(o.o,{children:Object(W.jsxs)("h2",{children:["Serial: ",Object(W.jsx)("span",{children:w.serial})]})})}),Object(W.jsx)(o.l,{children:Object(W.jsx)(le,{code:null===w||void 0===w||null===(r=w.vehicle)||void 0===r||null===(i=r.licensePlate)||void 0===i?void 0:i.code,region:null===w||void 0===w||null===(a=w.vehicle)||void 0===a||null===(l=a.licensePlate)||void 0===l?void 0:l.region,number:null===w||void 0===w||null===(d=w.vehicle)||void 0===d||null===(s=d.licensePlate)||void 0===s?void 0:s.plate})}),Object(W.jsx)(o.l,{children:Object(W.jsxs)(o.o,{children:[Object(W.jsx)("h2",{children:"Vehicle Type"}),Object(W.jsx)(o.f,{color:"tertiary",children:ee[null===w||void 0===w||null===(u=w.vehicle)||void 0===u?void 0:u.type]||"Unknown"})]})}),null!==w&&void 0!==w&&w.buyer?Object(W.jsx)(o.l,{className:"customer-row",children:Object(W.jsxs)(o.o,{children:[Object(W.jsx)("h2",{children:"Buyer"}),Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{className:"name",children:null===(j=w.buyer.name)||void 0===j?void 0:j.display}),Object(W.jsx)(o.f,{children:null===(b=w.buyer.phoneNumber)||void 0===b?void 0:b.number})]})]})}):Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(o.l,{button:!0,onClick:function(){return fe("buyer")},children:[Object(W.jsx)(o.j,{icon:L.t}),Object(W.jsx)(o.o,{children:"Add Buyer"})]})}),null!==w&&void 0!==w&&w.seller?Object(W.jsx)(o.l,{className:"customer-row",children:Object(W.jsxs)(o.o,{children:[Object(W.jsx)("h2",{children:"Seller"}),Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{className:"name",children:null===(h=w.seller.name)||void 0===h?void 0:h.display}),Object(W.jsx)(o.f,{children:null===(v=w.seller.phoneNumber)||void 0===v?void 0:v.number})]})]})}):Object(W.jsxs)(o.l,{button:!0,onClick:function(){return fe("seller")},children:[Object(W.jsx)(o.j,{icon:L.t}),Object(W.jsx)(o.o,{children:"Add Seller"})]})]})}),Object(W.jsxs)("div",{className:"card-right-content",children:[Object(W.jsxs)("div",{className:"weight-entry first-weight",children:[Object(W.jsx)("h3",{children:"First Weight"}),Object(W.jsx)("span",{className:"record-date",children:be(+(null===w||void 0===w||null===(O=w.weights[0])||void 0===O?void 0:O.createdAt))}),Object(W.jsxs)("div",{className:k()("weight-measure",(null===w||void 0===w||null===(m=w.weights[0])||void 0===m?void 0:m.manual)&&"manual-input"),children:[null===w||void 0===w||null===(p=w.weights[0])||void 0===p?void 0:p.weight.toLocaleString()," KG",(null===w||void 0===w||null===(f=w.weights[0])||void 0===f?void 0:f.manual)&&Object(W.jsxs)(o.f,{color:"secondary",children:[Object(W.jsx)(o.j,{icon:L.n}),Object(W.jsx)(o.o,{children:"Manual"})]})]}),(null===w||void 0===w?void 0:w.weights[1])&&ae()(+w.weights[0].createdAt).isAfter(ae()().subtract(2,"days"))&&Object(W.jsxs)(o.b,{onClick:function(){return me(w.weights[0].weight,w.weights[0].createdAt)},className:"use-record-button",color:"success",fill:"outline",children:[Object(W.jsx)(o.j,{icon:L.a}),"New Record"]})]}),"result"!==e.type||null!==w&&void 0!==w&&w.weights[1]?Object(W.jsx)(W.Fragment,{children:null!==w&&void 0!==w&&w.weights[1]||he()?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:"weight-entry second-weight",children:[Object(W.jsx)("h3",{children:"Second Weight"}),null!==w&&void 0!==w&&w.weights[1]?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("span",{className:"record-date",children:be(+(null===(g=w.weights[1])||void 0===g?void 0:g.createdAt))}),Object(W.jsxs)("div",{className:k()("weight-measure",(null===w||void 0===w||null===(x=w.weights[1])||void 0===x?void 0:x.manual)&&"manual-input"),children:[w.weights[1].weight.toLocaleString()," KG",(null===w||void 0===w||null===(y=w.weights[1])||void 0===y?void 0:y.manual)&&Object(W.jsxs)(o.f,{color:"secondary",children:[Object(W.jsx)(o.j,{icon:L.n}),Object(W.jsx)(o.o,{children:"Manual"})]})]}),ae()(+w.weights[1].createdAt).isAfter(ae()().subtract(2,"days"))&&Object(W.jsxs)(o.b,{onClick:function(){return me(w.weights[1].weight,w.weights[1].createdAt)},className:"use-record-button",color:"success",fill:"outline",children:[Object(W.jsx)(o.j,{icon:L.a}),"New Record"]})]}):Object(W.jsx)(W.Fragment,{children:he()?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)("span",{className:"record-date",children:be(+he().receivedAt)}),Object(W.jsxs)("div",{className:k()("weight-measure",ye()&&xe()?"green-draft":"red-draft"),children:[he().weight.toLocaleString()," KG",!xe()&&Object(W.jsx)(o.b,{className:"update-button",onClick:function(){var n,t,r,c,i,a;e.reading&&e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{reading:e.reading,licensePlate:{plate:(null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t?void 0:t.plate)||"",code:(null===(r=e.draft)||void 0===r||null===(c=r.licensePlate)||void 0===c?void 0:c.code)||3,region:(null===(i=e.draft)||void 0===i||null===(a=i.licensePlate)||void 0===a?void 0:a.region)||"AA"}}))},color:"dark",shape:"round",size:"small",fill:"clear",children:Object(W.jsx)(o.j,{icon:L.v})})]})]}):Object(W.jsx)(W.Fragment,{children:Object(W.jsx)("span",{className:"record-pending",children:"Pending"})})})]}),(he()||w.weights[1])&&Object(W.jsxs)("div",{className:"weight-entry net-weight",children:[Object(W.jsx)("h3",{children:"Net Weight"}),Object(W.jsx)("span",{className:"record-date",children:(null===w||void 0===w?void 0:w.weights[0])&&ae()(+(null===(R=w.weights[1])||void 0===R?void 0:R.createdAt)||(new Date).getTime()).from(+(null===(N=w.weights[0])||void 0===N?void 0:N.createdAt))}),Object(W.jsx)("div",{className:"weight-measure",children:function(){var e,n,t=w.weights[0].weight,r=(null===(e=w.weights[1])||void 0===e?void 0:e.weight)||(null===(n=he())||void 0===n?void 0:n.weight);return r?Math.abs(t-r).toLocaleString()+" KG":"..."}()})]})]}):Object(W.jsx)(W.Fragment,{})}):Object(W.jsxs)(o.c,{className:"price-card",color:V?"success":"warning",children:[Object(W.jsxs)("h1",{children:[function(e){switch(e){case 0:return 80;case 1:return 100;case 2:return 150;case 3:return 200;case 4:return 250;default:return 0}}(w.vehicle.type)," BIRR"]}),!V&&Object(W.jsx)(o.d,{children:Object(W.jsx)(o.b,{onClick:function(){G(!0)},expand:"block",color:"light",size:"large",slot:"end",children:"Paid"})})]}),he()?Object(W.jsxs)("div",{className:k()({"bottom-button":!0,"danger-button":!ye()||!xe(),"warn-button":ae()(+w.weights[0].createdAt).isBefore(ae()().subtract(2,"days"))}),children:[!(null!==w&&void 0!==w&&w.weights[1])&&ae()(+(null===w||void 0===w?void 0:w.weights[0].createdAt)).isBefore(ae()().subtract(2,"days"))&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(o.b,{color:"warning",disabled:!0,className:"time-warning",children:[Object(W.jsx)(o.j,{icon:L.b}),Object(W.jsx)(o.o,{children:ae()(+(null===w||void 0===w?void 0:w.weights[0].createdAt)).fromNow()})]})}),Object(W.jsxs)(o.b,{onClick:function(){console.log(he()),T({variables:{recordId:w.id,weight:he().weight,manual:he().manual,createdAt:he().receivedAt.toString()},update:function(){ie.refetch()}}),e.updateRecordResult(w.id),e.deleteRecordDraft()},size:"large",expand:"block",children:["Use Second Weight",Object(W.jsx)(o.j,{icon:L.h})]})]}):Object(W.jsxs)(W.Fragment,{children:["result"===e.type&&!(null!==w&&void 0!==w&&w.weights[1])&&(w.weights[1]||"result"!==e.type||V)&&Object(W.jsxs)("div",{className:"right-button",children:[Object(W.jsxs)(o.b,{onClick:Oe,children:[Object(W.jsx)(o.j,{icon:L.B}),"Send SMS"]}),Object(W.jsxs)(o.b,{onClick:ve,children:[Object(W.jsx)(o.j,{icon:L.u}),"Print"]})]}),Object(W.jsx)("div",{className:"right-button",children:Object(W.jsx)(o.b,{size:"large",onClick:function(e){return J({event:e.nativeEvent})},children:Object(W.jsx)(o.j,{icon:L.q})})})]})]})]}),e.ui.addCustomerForm&&e.ui.addCustomerForm.recordId===w.id&&Object(W.jsxs)(o.c,{className:"add-customer-card",children:[Object(W.jsxs)(o.b,{shape:"round",fill:"clear",color:"danger",onClick:ge,children:[Object(W.jsx)(o.j,{icon:L.l}),"Cancel"]}),Object(W.jsx)(pe,{noTitle:!0,party:e.ui.addCustomerForm.party,type:"card-form",onSelectCustomer:function(e,n){console.log(w.id,e,n),$({variables:{recordId:w.id,customerId:e,customerType:n},update:function(){ie.refetch()}}),ge()}})]}),Object(W.jsx)(o.x,{color:"success",cssClass:"printing-toast",isOpen:B,onDidDismiss:function(){return q(!1)},message:"PRINTING...",duration:2e3})]})})})),ge=(t(157),Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r=function(){var n,t,r;return(null===(n=e.reading)||void 0===n?void 0:n.weight)===(null===(t=e.draft)||void 0===t||null===(r=t.reading)||void 0===r?void 0:r.weight)},c=function(){var n,t,r;return(null===(n=e.reading)||void 0===n?void 0:n.receivedAt)-1e3<(null===(t=e.draft)||void 0===t||null===(r=t.reading)||void 0===r?void 0:r.receivedAt)},i=function(){var n,t;return(null===(n=e.draft)||void 0===n||null===(t=n.reading)||void 0===t?void 0:t.weight)>=1e3};return Object(W.jsxs)(o.c,{className:k()("current-weight-card","entity-card",i()&&r()&&!c()?"green-card":"red-card"),children:[Object(W.jsxs)(o.e,{children:[Object(W.jsx)("div",{children:"Recorded Weight"}),Object(W.jsxs)(o.b,{onClick:function(){e.deleteRecordDraft()},shape:"round",fill:"clear",color:i()&&r()&&!c()?"light":"dark",children:[Object(W.jsx)(o.j,{slot:"start",icon:L.k}),"Clear"]})]}),Object(W.jsx)(o.d,{children:Object(W.jsxs)("div",{className:"current-weight-measure",children:[null===(n=e.draft)||void 0===n||null===(t=n.reading)||void 0===t?void 0:t.weight.toLocaleString()," KG",(!r()||c())&&Object(W.jsxs)(o.b,{onClick:e.onRecord,shape:"round",fill:"solid",color:"dark",children:[Object(W.jsx)(o.j,{slot:"start",icon:L.v}),"Update"]})]})})]})}))),xe=Object(U.a)(R||(R=Object($.a)(["\n  query FetchVehicles($query: String, $limit: Int) {\n    vehicles(query: $query, limit: $limit) {\n      id\n      type\n      licensePlate {\n        plate\n        code\n        region {\n          code\n        }\n      }\n    }\n  }\n"]))),ye=Object(U.a)(N||(N=Object($.a)(["\n  query FetchVehicle($id: String) {\n    vehicle(id: $id) {\n      id\n      type\n      licensePlate {\n        plate\n        code\n        region {\n          code\n        }\n      }\n    }\n  }\n"]))),Re=Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,updateRecordQuery:A,deleteRecordDraft:P})((function(e){var n,t,r,c,i=Object(te.a)(xe,{variables:{query:null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t?void 0:t.plate,limit:5},fetchPolicy:"network-only"}),a=Object(te.a)(re,{variables:{vehicleId:null===(r=e.draft)||void 0===r?void 0:r.vehicleId},fetchPolicy:"network-only"});return Object(W.jsx)(o.c,{children:Object(W.jsx)(o.p,{lines:"full",className:"vehicle-suggestions",children:Object(W.jsxs)(o.n,{children:[Object(W.jsx)(o.m,{children:Object(W.jsx)(o.o,{children:"Select Existing Vehicle"})}),null===(c=i.data)||void 0===c?void 0:c.vehicles.map((function(n){return Object(W.jsxs)(o.l,{button:!0,onClick:function(){return function(n){a.refetch(),e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{vehicleId:n.id})),e.updateRecordQuery(n.licensePlate.plate)}(n)},children:[Object(W.jsx)(le,{number:n.licensePlate.plate,region:n.licensePlate.region,code:n.licensePlate.code}),Object(W.jsx)(o.f,{color:"secondary",children:ee[n.type]||"UNKNOWN"})]},n.id)}))]})})})})),Ne=Object(U.a)(w||(w=Object($.a)(["\n  mutation CreateVehicle(\n    $type: Int!\n    $plateNumber: String!\n    $plateCode: Int!\n    $plateRegion: String!\n  ) {\n    createVehicle(\n      type: $type\n      plateNumber: $plateNumber\n      plateCode: $plateCode\n      plateRegion: $plateRegion\n    ) {\n      id\n      type\n      licensePlate {\n        code\n        plate\n        region {\n          code\n        }\n      }\n    }\n  }\n"]))),we=(Object(U.a)(D||(D=Object($.a)(["\n  mutation UpdateVehicle(\n    $id: String!\n    $type: Int\n    $plateNumber: String\n    $plateCode: Int\n    $plateRegion: String\n  ) {\n    updateVehicle(\n      id: $id\n      type: $type\n      plateNumber: $plateNumber\n      plateCode: $plateCode\n      plateRegion: $plateRegion\n    ) {\n      id\n      type\n      licensePlate {\n        code\n        plate\n        region {\n          code\n        }\n      }\n    }\n  }\n"]))),Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r,c,i,a=Object(ne.a)(Ne),l=Object(Z.a)(a,1)[0];return Object(W.jsxs)(o.c,{className:"entity-card",children:[Object(W.jsx)(o.p,{lines:"full",className:"vehicle-suggestions",children:Object(W.jsxs)(o.n,{children:[Object(W.jsx)(o.m,{children:Object(W.jsx)(o.o,{children:"Create New Vehicle"})}),Object(W.jsx)(o.d,{className:"vehicle-form",children:Object(W.jsxs)("div",{className:"vehicle-form-content",children:[Object(W.jsx)("div",{children:Object(W.jsx)(le,{number:e.draft.licensePlate.plate,code:e.draft.licensePlate.code,region:{code:e.draft.licensePlate.region}})}),Object(W.jsxs)("div",{className:"vehicle-type",children:[Object(W.jsx)(o.o,{children:"Select Vehicle Type:"}),Object(W.jsx)("div",{children:ee.map((function(n,t){var r;return Object(W.jsx)(o.b,{onClick:function(){return function(n){e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{vehicle:{type:n}}))}(t)},shape:"round",fill:(null===(r=e.draft.vehicle)||void 0===r?void 0:r.type)===t?"solid":"outline",color:"secondary",children:n},t)}))})]})]})})]})}),Object(W.jsxs)(o.b,{expand:"full",onClick:function(){var n,t,r,c,i=e.draft;i&&!isNaN(null===(n=i.vehicle)||void 0===n?void 0:n.type)&&null!==(t=i.licensePlate)&&void 0!==t&&t.plate&&null!==(r=i.licensePlate)&&void 0!==r&&r.code&&null!==(c=i.licensePlate)&&void 0!==c&&c.region?l({variables:{type:i.vehicle.type,plateNumber:i.licensePlate.plate,plateCode:i.licensePlate.code,plateRegion:i.licensePlate.region}}).then((function(n){var t=n.data.createVehicle.id;e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{vehicleId:t,vehicle:{type:i.vehicle.type}}))})).catch(console.error):alert("Vehicle information incomplete")},disabled:(null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t||null===(r=t.plate)||void 0===r?void 0:r.length)<5||isNaN(null===(c=e.draft)||void 0===c||null===(i=c.vehicle)||void 0===i?void 0:i.type),children:[Object(W.jsx)(o.j,{icon:L.a}),"Create New Vehicle"]})]})}))),De=Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft}}),{updateRecordDraft:I,updateRecordQuery:A,deleteRecordDraft:P,updateUIState:E})((function(e){var n,t,r,i,a,l,d,s,u,j,b,h=Object(te.a)(xe,{variables:{query:null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t?void 0:t.plate,limit:5},fetchPolicy:"network-only"});Object(c.useEffect)((function(){return function(){return h.data}}),[h.data]);return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(o.c,{className:"license-plate-form entity-card",children:Object(W.jsxs)(o.l,{children:[Object(W.jsx)(o.k,{id:"license-plate-input",onIonChange:function(n){var t,r,c,i=null===(t=n.detail)||void 0===t?void 0:t.value.split(/[^a-zA-Z0-9]/).join("").trim().toUpperCase();n.target.value=i,e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{licensePlate:Object(Y.a)(Object(Y.a)({},null===(r=e.draft)||void 0===r?void 0:r.licensePlate),{},{plate:i})})),e.updateRecordQuery(null===(c=e.draft)||void 0===c?void 0:c.licensePlate.plate),e.updateUIState({page:0}),h.refetch()},debounce:500,maxlength:6,size:6,required:!0,autofocus:!0,pattern:"/[a-zA-Z0-9]/",placeholder:"Enter License Plate",clearInput:!0,className:"uppercase align-right"}),Object(W.jsx)(o.u,{onIonChange:function(n){var t,r,c=null===(t=n.detail)||void 0===t?void 0:t.value;e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{licensePlate:Object(Y.a)(Object(Y.a)({},null===(r=e.draft)||void 0===r?void 0:r.licensePlate),{},{code:c})})),h.refetch()},value:"number"===typeof(null===(r=e.draft)||void 0===r||null===(i=r.licensePlate)||void 0===i?void 0:i.code)?e.draft.licensePlate.code:3,interface:"popover",children:J.map((function(e,n){return Object(W.jsx)(o.v,{value:n,children:"number"===typeof e?"CODE 0".concat(e):e},e)}))}),Object(W.jsx)(o.u,{id:"plate-region-select",onIonChange:function(n){var t,r,c=null===(t=n.detail)||void 0===t?void 0:t.value;e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{licensePlate:Object(Y.a)(Object(Y.a)({},null===(r=e.draft)||void 0===r?void 0:r.licensePlate),{},{region:c})})),h.refetch()},value:(null===(a=e.draft)||void 0===a||null===(l=a.licensePlate)||void 0===l?void 0:l.region)||"AA",interface:"action-sheet",children:X.map((function(e){return Object(W.jsxs)(o.v,{value:e.code,children:["OTHER"!==e.code?"[".concat(e.code,"] "):"",e.name]},e.code)}))})]})}),(null===(d=e.draft)||void 0===d||null===(s=d.licensePlate)||void 0===s?void 0:s.plate)&&Object(W.jsxs)(W.Fragment,{children:[(null===(u=h.data)||void 0===u||null===(j=u.vehicles)||void 0===j?void 0:j.length)>0&&Object(W.jsx)(Re,{}),0===(null===(b=h.data)||void 0===b?void 0:b.vehicles.filter((function(n){var t=n.licensePlate,r=e.draft.licensePlate;return t.plate===r.plate&&t.code===r.code&&t.region.code===r.region})).length)&&Object(W.jsx)(we,{})]})]})})),Ce=Object(u.b)((function(e){return{draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r,c=Object(te.a)(ye,{variables:{id:null===(n=e.draft)||void 0===n?void 0:n.vehicleId},fetchPolicy:"network-only"});return Object(W.jsx)(W.Fragment,{children:(null===(t=c.data)||void 0===t||null===(r=t.vehicle)||void 0===r?void 0:r.licensePlate)&&Object(W.jsxs)(o.c,{className:"selected-vehicle-wrap entity-card",children:[Object(W.jsxs)(o.e,{children:[Object(W.jsx)("div",{children:"Selected Vehicle"}),Object(W.jsxs)(o.b,{onClick:e.onClear,fill:"clear",shape:"round",color:"danger",children:[Object(W.jsx)(o.j,{icon:L.k}),"Clear"]})]}),Object(W.jsxs)(o.d,{className:"content-row",children:[Object(W.jsx)("div",{children:Object(W.jsx)(le,{number:c.data.vehicle.licensePlate.plate,code:c.data.vehicle.licensePlate.code,region:c.data.vehicle.licensePlate.region})}),Object(W.jsx)("div",{children:Object(W.jsx)(o.f,{color:"secondary",children:e.getVehicleType(c.data.vehicle.type)})})]})]})})})),Ee=(t(158),Object(u.b)((function(e){return{draft:e.record.recordDraft}}),{updateRecordDraft:I,deleteRecordDraft:P})((function(e){var n,t,r,c=null===(t=Object(te.a)(he,{variables:{id:"seller"===e.party?null===(n=e.draft)||void 0===n?void 0:n.sellerId:e.draft.buyerId},fetchPolicy:"network-only"}).data)||void 0===t?void 0:t.customer;return Object(W.jsx)(W.Fragment,{children:c&&Object(W.jsxs)(o.c,{className:"selected-customer-wrap entity-card",children:[Object(W.jsxs)(o.e,{children:[Object(W.jsxs)("div",{children:["Selected ",e.party]}),Object(W.jsxs)(o.b,{onClick:e.onClear,fill:"clear",shape:"round",color:"danger",children:[Object(W.jsx)(o.j,{icon:L.k}),"Clear"]})]}),Object(W.jsxs)(o.d,{className:"content-row",children:[Object(W.jsxs)("div",{className:"name",children:[e.party,"'s Name: ",null===(r=c.name)||void 0===r?void 0:r.display]}),Object(W.jsxs)("div",{className:"phone-number",children:["Phone Number: ",c.phoneNumber.number]})]})]})})}))),Ie=Object(u.b)((function(e){return{reading:e.scoreboard.reading,draft:e.record.recordDraft,result:e.record.recordResult}}),{updateReading:C,updateRecordDraft:I,updateRecordResult:S,deleteRecordDraft:P,updateUIState:E})((function(e){var n,t,r,c,i=Object(ne.a)(de),a=Object(Z.a)(i,1)[0],l=Object(te.a)(ce,{variables:{id:e.result},skip:!e.result,fetchPolicy:"network-only"}),d=Object(te.a)(re,{variables:{vehicleId:null===(n=e.draft)||void 0===n?void 0:n.vehicleId},fetchPolicy:"network-only"}),s=Object(te.a)(ce,{variables:{id:null===(t=e.draft)||void 0===t?void 0:t.recordId},fetchPolicy:"network-only"}),u=function(){e.deleteRecordDraft(),e.updateRecordResult(void 0),e.updateUIState({page:0})},j=function(){var n,t,r;return(null===(n=e.reading)||void 0===n?void 0:n.weight)===(null===(t=e.draft)||void 0===t||null===(r=t.reading)||void 0===r?void 0:r.weight)},b=function(){var n,t;return(null===(n=e.draft)||void 0===n||null===(t=n.reading)||void 0===t?void 0:t.weight)>=1e3},h=function(){var n,t,r,c,i,a,l,d,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(u(),e.reading)&&(e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{reading:e.reading,licensePlate:{plate:(null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t?void 0:t.plate)||"",code:(null===(r=e.draft)||void 0===r||null===(c=r.licensePlate)||void 0===c?void 0:c.code)||3,region:(null===(i=e.draft)||void 0===i||null===(a=i.licensePlate)||void 0===a?void 0:a.region)||"AA"},skipBuyer:(null===(l=e.draft)||void 0===l?void 0:l.skipBuyer)||o,skipSeller:(null===(d=e.draft)||void 0===d?void 0:d.skipSeller)||s})),setTimeout((function(){var n,t,r=q()("#license-plate-input").find("input").first();r.trigger("focus"),r.val=null===(n=e.draft)||void 0===n||null===(t=n.licensePlate)||void 0===t?void 0:t.plate}),200))},v=function(n){var t="seller"===n?{skipSeller:void 0}:{skipBuyer:void 0};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),t))},O=function(n,t){var r="seller"===t?{sellerId:n}:{buyerId:n};e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),r))};return Object(W.jsxs)("div",{children:[e.draft&&e.draft.recordId&&Object(W.jsx)("div",{className:"existing-record",children:Object(W.jsx)(fe,{record:null===(c=s.data)||void 0===c?void 0:c.record,secondWeightDraft:e.draft.reading})},null===(r=s.data)||void 0===r?void 0:r.record.id),Object(W.jsx)("div",{className:"form-wrap",children:e.draft?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(ge,{onRecord:h}),e.draft.vehicleId?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ce,{getVehicleType:function(e){return ee[e]||"UNKNOWN"},onClear:function(){e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{vehicleId:void 0,vehicle:void 0})),e.updateUIState({page:0})}}),e.draft.buyerId||e.draft.skipBuyer?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Ee,{party:"buyer",onClear:function(){e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{buyerId:void 0,buyer:void 0}))}}),e.draft.sellerId?Object(W.jsx)(Ee,{party:"seller",onClear:function(){e.updateRecordDraft(Object(Y.a)(Object(Y.a)({},e.draft),{},{sellerId:void 0,seller:void 0}))}}):Object(W.jsx)(W.Fragment,{children:e.draft.skipSeller?"":Object(W.jsx)(pe,{onSelectCustomer:O,party:"seller"})})]}):Object(W.jsx)(W.Fragment,{children:e.draft.skipBuyer?"":Object(W.jsx)(pe,{onSelectCustomer:O,party:"buyer"})}),e.draft.skipBuyer&&Object(W.jsx)(o.c,{children:Object(W.jsxs)(o.b,{onClick:function(){return v("buyer")},fill:"outline",expand:"block",children:[Object(W.jsx)(o.j,{icon:L.a}),"Add Buyer"]})}),e.draft.skipSeller&&Object(W.jsx)(o.c,{children:Object(W.jsxs)(o.b,{onClick:function(){return v("seller")},fill:"outline",expand:"block",children:[Object(W.jsx)(o.j,{icon:L.a}),"Add Seller"]})})]}):Object(W.jsx)(De,{}),e.draft.vehicleId&&(e.draft.sellerId||e.draft.skipSeller)&&(e.draft.buyerId||e.draft.skipBuyer)&&Object(W.jsx)(W.Fragment,{children:Object(W.jsxs)(o.c,{className:k()({"create-button-card":!0,"danger-button":!b()||!j()}),children:[" ",j()?!b()&&Object(W.jsx)(o.w,{children:"Weight is too small"}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(o.w,{children:"Weight has changed"}),Object(W.jsxs)(o.b,{className:"update-button",shape:"round",color:"secondary",fill:"solid",onClick:function(){return h()},children:[Object(W.jsx)(o.j,{icon:L.w}),"Update"]})]}),Object(W.jsxs)(o.b,{className:"create-button",size:"large",onClick:function(){var n,t,r=e.draft;r&&!isNaN(null===(n=r.reading)||void 0===n?void 0:n.weight)&&null!==(t=r.licensePlate)&&void 0!==t&&t.plate?a({variables:{weight:r.reading.weight,manual:r.reading.manual||!1,vehicleId:r.vehicleId,sellerId:r.sellerId||void 0,buyerId:r.buyerId||void 0},update:function(e,n){var t,r=n.data,c=null===r||void 0===r?void 0:r.createRecord.record,i=e.readQuery({query:re});e.writeQuery({query:re,data:[].concat(Object(z.a)(null===(t=i.records)||void 0===t?void 0:t.payload),[c])})}}).then((function(n){e.updateRecordResult(n.data.createRecord.id),e.deleteRecordDraft(),e.result&&(l.refetch(),d.refetch())})):alert("Record information incomplete")},children:[Object(W.jsx)(o.j,{icon:L.a}),"Create New Record"]})]})})]}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(o.c,{className:"big-record-button",color:"primary",button:!0,onClick:function(){return h(!0,!0)},children:[Object(W.jsx)(o.j,{icon:L.E}),"New Measurement"]}),l.data?Object(W.jsxs)(o.c,{className:"result-card",children:[Object(W.jsxs)(o.b,{fill:"clear",size:"large",expand:"block",color:"medium",onClick:u,className:"clear-form-button",children:[Object(W.jsx)(o.j,{icon:L.l}),"Clear"]}),Object(W.jsx)(fe,{record:l.data.record,type:"result"})]}):Object(W.jsx)(W.Fragment,{})]})})]})})),Se=(t(159),t(241)),Ae=t(246),Pe=t(247),Te=Object(u.b)((function(e){return{recordQuery:e.record.recordQuery,ui:e.ui,draft:e.record.recordDraft}}),{updateReading:C,updateRecordQuery:A,updateRecordList:function(e){return function(n){return n({type:r.UPDATE_RECORD_LIST,payload:e})}},updateUIState:E})((function(e){var n,t,r,c,i,a,l,d,s,u,j,b,h,v=Object(te.a)(re,{variables:{query:e.recordQuery,licensePlate:e.recordQueryLicensePlate,filters:Se.a(e.ui.recordFilters||[],null!==(n=e.draft)&&void 0!==n&&n.reading?["pending"]:[]),limit:e.ui.limit||20,page:e.ui.page||0},fetchPolicy:"network-only"});return Object(W.jsxs)("div",{className:"left-col",children:[Object(W.jsxs)(o.c,{className:"search-card",children:[Object(W.jsx)(o.t,{debounce:1e3,placeholder:"Find Record",onIonChange:function(n){var t;e.updateRecordQuery(null===(t=n.detail)||void 0===t?void 0:t.value),e.updateUIState({page:0})}}),Object(W.jsxs)(o.d,{children:[Object(W.jsxs)(o.b,{onClick:function(){return function(n){var t,r=null!==(t=e.ui.recordFilters)&&void 0!==t&&t.includes(n)?Ae.a([n])(e.ui.recordFilters):Pe.a(n)(e.ui.recordFilters);e.updateUIState({recordFilters:r})}("pending")},size:"small",color:"primary",shape:"round",fill:null!==(t=e.ui.recordFilters)&&void 0!==t&&t.includes("pending")?"solid":"outline",children:[Object(W.jsx)(o.j,{icon:L.p}),"Pending"]}),Object(W.jsx)(o.b,{shape:"round",fill:"clear",children:Object(W.jsx)(o.j,{icon:L.d})})]})]}),Object(W.jsxs)("div",{className:"results-list",children:[v.loading&&Object(W.jsx)(o.c,{className:"info-card",children:Object(W.jsx)("h3",{children:"LOADING..."})}),(!v.data||!(null!==(r=v.data)&&void 0!==r&&null!==(c=r.records)&&void 0!==c&&c.payload)||0===(null===(i=v.data)||void 0===i||null===(a=i.records)||void 0===a||null===(l=a.payload)||void 0===l?void 0:l.length))&&Object(W.jsx)(o.c,{className:"info-card",children:Object(W.jsx)("h3",{children:"NO RECORDS FOUND"})}),Object(W.jsx)("div",{className:"records-wrap",children:null===(d=v.data)||void 0===d||null===(s=d.records.payload)||void 0===s?void 0:s.map((function(e){return Object(W.jsx)(fe,{record:e},e.id)}))})]}),Object(W.jsxs)("div",{className:"pagination",children:[Object(W.jsx)(o.b,{onClick:function(){var n=+(e.ui.page||0);e.updateUIState({page:n>0?n-1:0})},disabled:e.ui.page<1,children:Object(W.jsx)(o.j,{icon:L.g})}),"Page ",+(e.ui.page||0)+1," of"," ",Math.ceil((null===(u=v.data)||void 0===u||null===(j=u.records)||void 0===j?void 0:j.count)/(e.ui.limit||20)),Object(W.jsx)(o.b,{onClick:function(){var n=+(e.ui.page||0);e.updateUIState({page:n+1})},disabled:e.ui.page>=Math.floor((null===(b=v.data)||void 0===b||null===(h=b.records)||void 0===h?void 0:h.count)/(e.ui.limit||20)),children:Object(W.jsx)(o.j,{icon:L.h})})]})]})})),_e=function(){return Object(W.jsxs)(o.q,{children:[Object(W.jsx)(o.i,{children:Object(W.jsx)(o.y,{children:Object(W.jsx)(K,{})})}),Object(W.jsxs)(o.g,{children:[Object(W.jsxs)("div",{className:"sidebar",children:[Object(W.jsxs)(o.p,{children:[Object(W.jsxs)(o.l,{button:!0,color:"primary",children:[Object(W.jsx)(o.j,{icon:L.o}),Object(W.jsx)(o.w,{children:"Home"})]}),Object(W.jsxs)(o.l,{button:!0,onClick:function(){},children:[Object(W.jsx)(o.j,{icon:L.e}),Object(W.jsx)(o.w,{children:"Vehicles"})]}),Object(W.jsxs)(o.l,{button:!0,children:[Object(W.jsx)(o.j,{icon:L.s}),Object(W.jsx)(o.w,{children:"Customers"})]}),Object(W.jsxs)(o.l,{button:!0,children:[Object(W.jsx)(o.j,{icon:L.F}),Object(W.jsx)(o.w,{children:"Reporting"})]})]}),Object(W.jsx)(o.p,{children:Object(W.jsxs)(o.l,{button:!0,children:[Object(W.jsx)(o.j,{icon:L.C}),Object(W.jsx)(o.w,{children:"Settings"})]})})]}),Object(W.jsx)("div",{className:"wrap",children:Object(W.jsxs)("div",{className:"content",children:[Object(W.jsx)(Te,{}),Object(W.jsx)(Ie,{})]})})]})]})},ke=(t(160),t(161),t(162),t(163),t(164),t(165),t(166),t(167),t(168),t(169),t(170),t(238)),$e=t(242),Ue=t(239),Fe=t(125),Le=t(244),Be=t(240),qe=t(118),Me=t(119),Qe=t(62),Ve=Object(qe.a)((function(e){var n=e.graphQLErrors;null===n||void 0===n||n.map(console.error)})),Ge="8998";console.log(Ge);var We=Object(ke.a)([Ve,new $e.a({uri:"http://localhost:".concat(Ge,"/")})]),He=new Me.a({uri:"ws://localhost:".concat(Ge,"/graphql"),options:{reconnect:!0}}),Ke=Object(Ue.a)((function(e){var n=e.query,t=Object(Qe.e)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),He,We),ze=new Fe.a({cache:new Le.a({typePolicies:{Record:{fields:{serial:{read:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"000";return e}}}}}}),link:Ke}),Ye=function(){return Object(W.jsx)(Be.a,{client:ze,children:Object(W.jsx)(o.a,{children:Object(W.jsx)(s.a,{children:Object(W.jsxs)(o.s,{children:[Object(W.jsx)(d.b,{exact:!0,path:"/home",children:Object(W.jsx)(_e,{})}),Object(W.jsx)(d.b,{exact:!0,path:"/",children:Object(W.jsx)(d.a,{to:"/home"})})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ze=function(e){e&&e instanceof Function&&t.e(58).then(t.bind(null,263)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,i=n.getLCP,a=n.getTTFB;t(e),r(e),c(e),i(e),a(e)}))},Je=t(65),Xe=Object(Je.b)({scoreboard:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.UPDATE_SCOREBOARD:return Object(Y.a)(Object(Y.a)({},e),{},{reading:n.payload});case r.RESET_SCOREBOARD:return 0;case r.DELETE_RECORD_DRAFT:return Object(Y.a)(Object(Y.a)({},e),{},{capture:n.payload});default:return e}},record:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case r.UPDATE_RECORD_DRAFT:return Object(Y.a)(Object(Y.a)({},e),{},{recordDraft:n.payload});case r.DELETE_RECORD_DRAFT:return Object(Y.a)(Object(Y.a)({},e),{},{recordDraft:void 0});case r.UPDATE_RECORD_RESULT:return Object(Y.a)(Object(Y.a)({},e),{},{recordResult:n.payload});case r.UPDATE_RECORD_QUERY:return Object(Y.a)(Object(Y.a)({},e),{},{recordQuery:n.payload});case r.UPDATE_RECORD_LIST:return Object(Y.a)(Object(Y.a)({},e),{},{recordList:n.payload});default:return e}},ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return n.type===r.UPDATE_UI_STATE?n.payload:e}}),en=t(121),nn=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Je.c,tn=[en.a],rn=Object(Je.d)(Xe,{},Object(Je.c)(Je.a.apply(void 0,tn),nn()));l.a.render(Object(W.jsx)(u.a,{store:rn,children:Object(W.jsx)(i.a.StrictMode,{children:Object(W.jsx)(Ye,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),Ze()}},[[180,3,4]]]);
//# sourceMappingURL=main.9604a429.chunk.js.map